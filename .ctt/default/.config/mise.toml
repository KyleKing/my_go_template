[env]
MISE_ENV = "hk"

[settings]
experimental = true

[tasks."brew:sha"]
description = "Print SHA256 for Homebrew formula (run after release)"
run = """
echo "Download binaries from the latest release and run:"
echo "  shasum -a 256 test-template-darwin-arm64 test-template-darwin-amd64 test-template-linux-arm64 test-template-linux-amd64"
echo ""
echo "Then update Formula/test-template.rb with the SHA256 values and version."
"""

[tasks.build]
description = "Build binary"
run = "go build -v -o test-template ./cmd/test-template"

[tasks.ci]
description = "Run all checks (used in GitHub Actions)"
run = ["go test -v ./...", "go build -v -o test-template ./cmd/test-template"]

[tasks.clean]
description = "Clean build artifacts"
run = "rm -f coverage.out"

[tasks.format]
description = "Format code with golangci-lint and golines"
run = ["golangci-lint run --fix ./...", "golines -w ."]

[tasks.hooks]
description = "Run git hooks"
run = "hk fix --quiet"

[tasks.lint]
description = "Run linter"
run = "golangci-lint run ./..."

[tasks.test]
description = "Run tests with coverage"
run = "go test -coverprofile=coverage.out ./..."

[tasks."test:view-coverage"]
description = "View coverage report in browser"
run = "go tool cover -html=coverage.out"
